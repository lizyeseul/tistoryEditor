<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="post-list">

	<delete id="deletePosts">
	/*deletePosts*/
	DELETE FROM post_list
	WHERE BLOG_UUID = #{blog_uuid}
	</delete>
	<insert id="insertPost">
	/*insertPost*/
	INSERT INTO post_list
	(
		POST_UUID,
		POST_ID,
		BLOG_UUID,
		CTGY_UUID,
		POST_NM,
		POST_URL,
		PUBLIC_CD,
		POST_DT,
		STAT_COMNT,
		STAT_TRKBK
	)
	SELECT 
		#{post_uuid},
		#{id},
		#{blog_uuid},
		CTGY_UUID,
		#{title},
		#{postUrl},
		#{visibility},
		#{date},
		#{comments},
		#{trackbacks}
	  FROM category_list
	 WHERE 1=1
	   AND CTGY_ID = #{categoryId}
	</insert>
	<select id="selectPostList" resultType="map">
	/*selectPostList*/
SELECT R1.* FROM (
	SELECT
		POST_UUID,
		POST_ID,
		BLOG_UUID,
		CTGY_UUID,
		POST_NM,
		POST_URL,
		PUBLIC_CD,
		POST_DT,
		STAT_COMNT,
		STAT_TRKBK
	FROM  post_list
	WHERE 1=1
	AND BLOG_UUID = #{blog_uuid}
	ORDER BY POST_DT DESC
) R1
LIMIT #{post_per_page, jdbcType=INTEGER} OFFSET #{selected_page, jdbcType=INTEGER}
	</select>
</mapper>